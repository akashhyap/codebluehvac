---
const serviceDropdown = [
  { label: "AC & Cooling", href: "/services/ac-cooling", children: [
    { label: "AC Repair", href: "/services/ac-repair" },
    { label: "AC Installation", href: "/services/ac-installation" },
    { label: "AC Replacement", href: "/services/ac-replacement" },
    { label: "AC Maintenance", href: "/services/ac-maintenance" },
    { label: "Emergency AC Repair", href: "/services/emergency-ac-repair" },
  ]},
  { label: "Heating", href: "/services/heating", children: [
    { label: "Furnace Repair", href: "/services/furnace-repair" },
    { label: "Furnace Installation", href: "/services/furnace-installation" },
    { label: "Heating Maintenance", href: "/services/heating-maintenance" },
  ]},
  { label: "Commercial HVAC", href: "/services/commercial-hvac", children: [
    { label: "Commercial AC Repair", href: "/services/commercial-ac-repair" },
    { label: "Commercial Installation", href: "/services/commercial-installation" },
    { label: "Commercial Maintenance", href: "/services/commercial-maintenance" },
  ]},
  { label: "Ductwork & Air Quality", href: "/services/ductwork-air-quality", children: [
    { label: "Ductwork Installation", href: "/services/ductwork-installation" },
    { label: "Ductwork Repair", href: "/services/ductwork-repair" },
    { label: "Duct Cleaning", href: "/services/duct-cleaning" },
    { label: "Air Purification", href: "/services/air-purification" },
  ]},
  { label: "Ductless Mini-Splits", href: "/services/ductless-mini-splits", children: [
    { label: "Ductless Installation", href: "/services/ductless-installation" },
    { label: "Ductless Repair", href: "/services/ductless-repair" },
  ]},
];

const navItems = [
  { label: "Home", href: "/" },
  { label: "About", href: "/about" },
  { label: "Services", href: "/services/ac-cooling", hasDropdown: true },
  { label: "Service Areas", href: "/service-areas" },
  { label: "Reviews", href: "/reviews" },
  { label: "Blog", href: "/blog" },
  { label: "Contact", href: "/contact" },
];

const currentPath = Astro.url.pathname;
---

<header id="site-header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300">
  <!-- Top bar -->
  <div class="bg-dark text-white hidden lg:block">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-10 text-xs">
      <div class="flex items-center gap-6">
        <a href="tel:+17028871656" class="flex items-center gap-1.5 hover:text-accent transition-colors">
          <svg class="w-3.5 h-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/></svg>
          (702) 887-1656
        </a>
        <span class="text-white/30">|</span>
        <a href="mailto:info@codebluehvac.com" class="hover:text-accent transition-colors">info@codebluehvac.com</a>
        <span class="text-white/30">|</span>
        <span class="text-white/50">3612 Sandy Brown Ave, North Las Vegas, NV 89031</span>
      </div>
      <div class="flex items-center gap-4">
        <span class="text-white/50">BBB A+ Accredited</span>
        <span class="flex items-center gap-1 text-green-400"><span class="w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"></span>24/7 Emergency Service</span>
      </div>
    </div>
  </div>

  <!-- Main nav -->
  <div class="bg-white/95 backdrop-blur-lg shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-20 lg:h-20">
        <a href="/" class="flex items-center gap-2 group">
          <div class="w-10 h-10 bg-accent rounded-lg flex items-center justify-center transition-transform group-hover:scale-105">
            <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 3v18M5.63 5.63l12.74 12.74M3 12h18M5.63 18.37l12.74-12.74"/><circle cx="12" cy="12" r="3"/></svg>
          </div>
          <div>
            <span class="font-heading text-2xl tracking-wider text-dark leading-none">CODE BLUE HVAC</span>
            <span class="block text-[9px] font-accent font-medium text-dark/40 uppercase tracking-[0.2em] -mt-0.5">Heating & Cooling</span>
          </div>
        </a>

        <nav class="hidden lg:flex items-center gap-1">
          {navItems.map((item) => (
            <div class="relative group">
              <a
                href={item.href}
                class:list={[
                  "px-4 py-2 text-sm font-accent font-medium tracking-wide uppercase transition-colors duration-200 rounded-lg inline-flex items-center gap-1",
                  currentPath === item.href || (item.href !== "/" && currentPath.startsWith(item.href))
                    ? "text-accent bg-accent/5"
                    : "text-dark/70 hover:text-accent hover:bg-accent/5"
                ]}
              >
                {item.label}
                {item.hasDropdown && (
                  <svg class="w-3 h-3 opacity-50" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
                )}
              </a>
              {item.hasDropdown && (
                <div class="absolute top-full left-0 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                  <div class="bg-white rounded-card shadow-xl border border-border/50 p-6 w-[700px]">
                    <div class="grid grid-cols-3 gap-6">
                      {serviceDropdown.map((category) => (
                        <div>
                          <a href={category.href} class="font-accent font-semibold text-dark text-sm hover:text-accent transition-colors">{category.label}</a>
                          <div class="mt-2 space-y-1">
                            {category.children.map((child) => (
                              <a href={child.href} class="block text-xs text-dark/50 hover:text-accent transition-colors py-0.5">{child.label}</a>
                            ))}
                          </div>
                        </div>
                      ))}
                    </div>
                    <div class="border-t border-border mt-4 pt-4">
                      <p class="text-xs font-accent font-semibold text-dark/40 uppercase tracking-wider mb-2">Quick Links</p>
                      <div class="flex gap-4">
                        <a href="/financing" class="text-xs text-dark/50 hover:text-accent transition-colors">Financing</a>
                        <a href="/specials" class="text-xs text-dark/50 hover:text-accent transition-colors">Specials & Discounts</a>
                        <a href="/reviews" class="text-xs text-dark/50 hover:text-accent transition-colors">Customer Reviews</a>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>
          ))}
        </nav>

        <div class="flex items-center gap-3">
          <a href="tel:+17028871656" class="hidden sm:inline-flex items-center gap-2 bg-accent text-white px-5 py-2.5 rounded-card text-sm font-accent font-semibold uppercase tracking-wide hover:bg-accent-dark transition-colors duration-200">
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/></svg>
            (702) 887-1656
          </a>
          <button id="mobile-menu-btn" class="lg:hidden p-2 rounded-lg hover:bg-light transition-colors" aria-label="Toggle menu">
            <svg id="menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round"/></svg>
            <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M6 18L18 6M6 6l12 12" stroke-linecap="round"/></svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden lg:hidden bg-white/95 backdrop-blur-lg border-t border-border">
    <div class="max-w-7xl mx-auto px-4 py-4 space-y-1 max-h-[80vh] overflow-y-auto">
      {navItems.map((item) => (
        <a href={item.href} class:list={["block px-4 py-3 rounded-lg text-sm font-accent font-medium uppercase tracking-wide transition-colors", currentPath === item.href ? "text-accent bg-accent/5" : "text-dark/70 hover:text-accent hover:bg-accent/5"]}>{item.label}</a>
      ))}
      {serviceDropdown.map((cat) => (
        <div class="pl-4">
          <a href={cat.href} class="block px-4 py-2 text-xs font-accent font-semibold text-dark/60 uppercase">{cat.label}</a>
          {cat.children.map((child) => (
            <a href={child.href} class="block px-8 py-1.5 text-xs text-dark/40 hover:text-accent">{child.label}</a>
          ))}
        </div>
      ))}
      <a href="tel:+17028871656" class="block text-center mt-4 bg-accent text-white px-5 py-3 rounded-card text-sm font-accent font-semibold uppercase tracking-wide">(702) 887-1656</a>
    </div>
  </div>
</header>

<script>
  const menuBtn = document.getElementById('mobile-menu-btn');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');
  const closeIcon = document.getElementById('close-icon');
  menuBtn?.addEventListener('click', () => {
    mobileMenu?.classList.toggle('hidden');
    menuIcon?.classList.toggle('hidden');
    closeIcon?.classList.toggle('hidden');
  });
</script>
